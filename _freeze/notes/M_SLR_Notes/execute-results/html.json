{
  "hash": "287e22305a5207bcd565c8a4256bdf12",
  "result": {
    "markdown": "---\ntitle: \"Notes L\"\nsubtitle: \"Exploratory Data Analysis & Simple Linear Regression\"\nformat:\n  html:\n    toc: true\n    code-overflow: wrap\n    code-fold: false\n    embed-resources: true\nexecute: \n  message: FALSE\n  warning: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#LOAD PACKAGES\nlibrary(tidyverse)\nlibrary(infer)\nlibrary(broom)\nset.seed(999)\n```\n:::\n\n\nLet's this about some ways we can summarize and explore relationships between two variables: \n\n::: {#fig-plots layout-ncol=3}\n\n![Two Categorical](https://forum.posit.co/uploads/default/original/3X/3/e/3e5e010f63ffeb5e555d1e202e4b637525d43b48.jpeg){#fig-two-cat}\n\n![One Numeric, One Categorical](https://allisonhorst.github.io/palmerpenguins/articles/examples_files/figure-html/unnamed-chunk-6-1.png){#fig-one-num-one-cat}\n\n![Two Numeric Variables](https://allisonhorst.github.io/palmerpenguins/articles/examples_files/figure-html/mass-flipper-1.png){#fig-two-num}\n\n\n\nTypes of Plots with Two Variables\n:::\n\nToday, we are going to dive into the \"two numeric variables\" case. \n\n# Motivation using data we have seen before\n\n## Sustainability Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#LOAD DATA\npower <- read.csv(\"../data/power.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n power %>% \n   drop_na() %>% \n   ggplot(aes(x=windSpeedRadarTower_m_per_sec, y=power_kW)) + \n   geom_point(pch=16, alpha=0.5, position=\"jitter\") + \n   geom_smooth(method=lm, se=FALSE) +\n   labs(x = \"Wind Speed (m/s)\", y = \"Power (kW)\") + \n   theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Banner-tailed Kangaroo Rats in Portal, AZ\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#load kangaroo rat data\nkangaroo_rats <- read.csv(\"https://github.com/weecology/PortalData/raw/main/Rodents/Portal_rodent.csv\") %>% \n  filter(species %in% c(\"DS\")) %>% \n  select(year, month, day, species, sex, hfl, wgt)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats %>% \n   drop_na() %>% \n   ggplot(aes(x=hfl, y=wgt)) + \n   geom_point(pch=16, alpha=0.5, position=\"jitter\") + \n   geom_smooth(method=lm, se=FALSE) +\n   labs(x = \"Hindfoot Length\", y = \"Weight\") + \n   theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n# Correlation\n\nCorrelation always takes on values between -1 and 1, describes the strength of the linear relationship between two variables. \n\n![](https://www.mathsisfun.com/data/images/correlation-examples.svg)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats <- kangaroo_rats %>% \n  drop_na(hfl) %>% \n  drop_na(wgt)\n\n#cor(x, y)\ncor(kangaroo_rats$hfl, kangaroo_rats$wgt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4741858\n```\n:::\n:::\n\n\n\n# Correlation Does Not Imply Causation\n\n![](https://www.simplypsychology.org/wp-content/uploads/causation-correlation.jpg)\n\n![](https://streamlined.co.nz/wp-content/uploads/2016/11/Blog-item_correlation-and-cause_buzzfeed-image.png)\n![](https://lh4.googleusercontent.com/aah2iNgrOSrrgbf_ff2LDYrFdbiYju7P6gvuTLneQ6Rf0ShcwChgUF-Qd8z3ycZVYT1MUMe90Uk2yeLMYdvmbCYoKd321XYyF3C4Det0ouBZvvA-_Lqhp43Nx1B0iVaEZim8DoOH)\n\n\n# Equations and Interpretation of Coefficients\n\nWant to fit a linear model: \n\n$$\n\\hat{y} = b_0 + b_1x\n$$\n\nTo fit a linear regression model we need the `lm()` function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#modelname <- lm(y ~ x, data = dataset)\n\npower_model <- lm(power_kW ~ windSpeedRadarTower_m_per_sec,data=power)\n\n# calling the name of the model spits out the coefficients (slope and y-intercept)\npower_model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = power_kW ~ windSpeedRadarTower_m_per_sec, data = power)\n\nCoefficients:\n                  (Intercept)  windSpeedRadarTower_m_per_sec  \n                      -2.5469                         0.8558  \n```\n:::\n:::\n\n\nTo interpret the y-intercept coefficient ($b_0$): \n\n- If the wind speed is 0, this model predicts that the power generated will be -2.5 kW on average. \n\nTo interpret the slope coefficient ($b_1$): \n\n- For every additional m per sec of wind speed, this model predicts that the power generated will increase by 0.8558 kW. \n\n\n# Variability of the Slope Estimates\n\n- we are usually using a sample to try to estimate was is going on with the population\n- statistics which summarize sample data (like slope) vary from sample to sample\n\nConsider the Banner-tailed kangaroo rats. The full dataset is 2575 kangaroo rats, but this is only a subset of all kangaroo rats in the world.\n\nSuppose we only had a sample of 500. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats_sample1 <- kangaroo_rats %>%\n  sample_n(500)\n\nkangaroo_rats_sample1 %>% \n  ggplot(aes(x=hfl, y=wgt)) + \n  geom_point() + \n  geom_smooth(method=\"lm\", se=FALSE)\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nkangaroo_model1 <- lm(wgt ~ hfl, data=kangaroo_rats_sample1 )\n\nkangaroo_model1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = wgt ~ hfl, data = kangaroo_rats_sample1)\n\nCoefficients:\n(Intercept)          hfl  \n   -154.283        5.464  \n```\n:::\n:::\n\n\nIf we repeat this, we will get a slightly different slope. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats_sample2 <- kangaroo_rats %>%\n  sample_n(500)\n\nkangaroo_rats_sample2 %>% \n  ggplot(aes(x=hfl, y=wgt)) + \n  geom_point() + \n  geom_smooth(method=\"lm\", se=FALSE)\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nkangaroo_model2 <- lm(wgt ~ hfl, data=kangaroo_rats_sample2 )\n\nkangaroo_model2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = wgt ~ hfl, data = kangaroo_rats_sample2)\n\nCoefficients:\n(Intercept)          hfl  \n   -161.862        5.651  \n```\n:::\n:::\n\n\nLet's use some fancy R things to repeat this sampling process many times: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats_many <- kangaroo_rats %>% \n  rep_sample_n(size = 20, replace = FALSE, reps = 500)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  # plot the slopes of all the replicates\n  geom_smooth(\n    data = kangaroo_rats_many, aes(x = hfl, y = wgt, group = replicate),\n    method = \"lm\", se = FALSE, fullrange = TRUE, \n    color = \"grey\", linewidth = 0.1\n  ) +\n  # plot the slope of all kangaroo rats in Portal, AZ\n  geom_smooth(\n    data = kangaroo_rats, aes(x = hfl, y = wgt), method = \"lm\", se = FALSE,\n    fullrange = TRUE, color = \"blue\"\n  ) + \n  ggtitle(\"Repeated Samples of size n=500\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n- You might notice in the above figure that the $\\hat{y}$ values given by the lines are much more consistent in the middle of the dataset than at the ends. The reason is that the data itself anchors the lines in such a way that the line must pass through the center of the data cloud.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats_many_lm <- kangaroo_rats_many %>% \n  group_by(replicate) %>% \n  do(tidy(lm(wgt ~ hfl, data = .))) %>% \n  filter(term == \"hfl\")\n\nggplot(kangaroo_rats_many_lm, aes(x = estimate)) +\n  geom_histogram(binwidth=0.5) +\n  labs(\n    x = \"Slope estimate\",\n    y = \"Count\",\n    title = \"Banner-tailed Kangaroo Rats\",\n    subtitle = \"Many random samples of 500 rats\"\n  ) + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Notes_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\nUnderstanding how much the slope varies from sample to sample helps us better understand a range of likely values for the true slope!\n\n(Take a stats class to learn more!)\n\n# Assumptions, Residuals, and  Residual Plots \n\nThere are some! \n\n## Interpolation vs. Extrapolation\n\n**Interpolation** is a method of estimating a hypothetical value that exists within a data set.\n\n**Extrapolation** is a method of estimation for hypothetical values that fall outside a data set.\n\n![](https://i.ytimg.com/vi/gbND5b0F8zc/maxresdefault.jpg)\n\n\n",
    "supporting": [
      "M_SLR_Notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}