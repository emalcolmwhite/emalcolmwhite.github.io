{
  "hash": "ada079e94051d5451781bb5fc8311017",
  "result": {
    "markdown": "---\ntitle: \"Notes L\"\nsubtitle: \"Exploratory Data Analysis & Simple Linear Regression\"\nformat:\n  html:\n    toc: true\n    code-overflow: wrap\n    code-fold: false\n    embed-resources: true\nexecute: \n  message: FALSE\n  warning: FALSE\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#LOAD PACKAGES\nlibrary(tidyverse)\n```\n:::\n\n\n::: {#fig-plots layout-ncol=3}\n\n![Two Categorical](https://forum.posit.co/uploads/default/original/3X/3/e/3e5e010f63ffeb5e555d1e202e4b637525d43b48.jpeg)\n\n![One Numeric, One Categorical](https://allisonhorst.github.io/palmerpenguins/articles/examples_files/figure-html/unnamed-chunk-6-1.png){#fig-one-num-one-cat}\n\n![Two Numeric Variables](https://allisonhorst.github.io/palmerpenguins/articles/examples_files/figure-html/mass-flipper-1.png){#fig-two-num}\n\n\n\nTypes of Plots with Two Variables\n:::\n\n\n# Motivation using data we have seen before\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#LOAD DATA\npower <- read.csv(\"../data/power.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n power %>% \n   drop_na() %>% \n   ggplot(aes(x=windSpeedRadarTower_m_per_sec, y=power_kW)) + \n   geom_point(pch=16, alpha=0.5, position=\"jitter\") + \n   geom_smooth(method=lm, se=FALSE) +\n   labs(x = \"Wind Speed (m/s)\", y = \"Power (kW)\") + \n   theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Blank_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#load kangaroo rat data\nkangaroo_rats <- read.csv(\"https://github.com/weecology/PortalData/raw/main/Rodents/Portal_rodent.csv\") %>% \n  filter(species %in% c(\"DS\")) %>% \n  select(year, month, day, species, sex, hfl, wgt)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats %>% \n   drop_na() %>% \n   ggplot(aes(x=hfl, y=wgt)) + \n   geom_point(pch=16, alpha=0.5, position=\"jitter\") + \n   geom_smooth(method=lm, se=FALSE) +\n   labs(x = \"Hindfoot Length\", y = \"Weight\") + \n   theme_minimal()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Blank_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n# Correlation\n\nCorrelation always takes on values between -1 and 1, describes the strength of the linear relationship between two variables. \n\n![](https://www.mathsisfun.com/data/images/correlation-examples.svg)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats <- kangaroo_rats %>% \n  drop_na(hfl) %>% \n  drop_na(wgt)\n\n#cor(x, y)\ncor(kangaroo_rats$hfl, kangaroo_rats$wgt)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4741858\n```\n:::\n:::\n\n\n\n\n# Correlation Does Not Imply Causation\n\n![](https://www.simplypsychology.org/wp-content/uploads/causation-correlation.jpg)\n\n![](https://streamlined.co.nz/wp-content/uploads/2016/11/Blog-item_correlation-and-cause_buzzfeed-image.png)\n![](https://lh4.googleusercontent.com/aah2iNgrOSrrgbf_ff2LDYrFdbiYju7P6gvuTLneQ6Rf0ShcwChgUF-Qd8z3ycZVYT1MUMe90Uk2yeLMYdvmbCYoKd321XYyF3C4Det0ouBZvvA-_Lqhp43Nx1B0iVaEZim8DoOH)\n\n\n# Equations and Interpretation of Coefficients\n\nWant to fit a linear model: \n\n$$\n\\hat{y} = b_0 + b_1x\n$$\n\nTo fit a linear regression model we need the `lm()` function. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#modelname <- lm(y ~ x, data = dataset)\n\npower_model <- lm(power_kW ~ windSpeedRadarTower_m_per_sec,data=power)\n\npower_model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = power_kW ~ windSpeedRadarTower_m_per_sec, data = power)\n\nCoefficients:\n                  (Intercept)  windSpeedRadarTower_m_per_sec  \n                      -2.5469                         0.8558  \n```\n:::\n:::\n\n\nTo interpret the y-intercept coefficient ($b_0$): \n\nIf the wind speed is 0, this model predicts that the power generated will be -2.5 kW on average. \n\nTo interpret the slope coefficient ($b_1$): \n\nFor every additional m per sec of wind speed, this model predicts that the power generated will increase by 0.8558 kW. \n\n\n# Variability of the Slope Estimates\n\n- a linear model varies from sample to sample\n\nConsider the Banner-tailed kangaroo rats. The full dataset is 2575 kangaroo rats, but this is only a subset of all kangaroo rats in the world.\n\nSuppose we only had a sample of 500. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rats_sample <- kangaroo_rats %>% \n  sample_n(500)\n\nkangaroo_rats_sample %>% \n  ggplot(aes(x=hfl, y=wgt)) + \n  geom_point()\n```\n\n::: {.cell-output-display}\n![](M_SLR_Blank_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\nkangaroo_model <- lm(wgt ~ hfl, data=kangaroo_rats_sample )\n\nsummary(kangaroo_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = wgt ~ hfl, data = kangaroo_rats_sample)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-56.186 -10.856   3.146  13.814  63.814 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -147.221     20.821  -7.071 5.24e-12 ***\nhfl            5.335      0.416  12.824  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.96 on 498 degrees of freedom\nMultiple R-squared:  0.2482,\tAdjusted R-squared:  0.2467 \nF-statistic: 164.4 on 1 and 498 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n\n\n\n# Assumptions, Residuals, and  Residual Plots \n\n## Assumptions of Linear Regression: \n\n- **Linearity:** The relationship between X and the mean of Y is linear -- look at scatterplot\n- **Homoscedasticity:** The variance of residual is the same for any value of X -- look at fitted vs. residuals plot\n- **Independence:** Observations are independent of each other -- think about context\n- **Normality:** For any fixed value of X, Y is normally distributed. -- check the QQ plot\n\n\n## Check the scatterplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# power %>% \n#   drop_na() %>% \n#   ggplot(aes(x=windSpeedRadarTower_m_per_sec, y=power_kW)) + \n#   geom_point(pch=16, alpha=0.5, position=\"jitter\") + \n#   geom_smooth(method=lm, se=FALSE) +\n#   labs(x = \"Wind Speed (m/s)\", y = \"Power (kW)\") + \n#   theme_minimal()\n```\n:::\n\n\nSome examples of nonlinear plots: \n\n\n\n## fitted vs. residuals plot and QQplots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(ggResidpanel)\n#resid_panel(power_model)\n```\n:::\n\n\nThe default panel includes the following four plots.\n\n- *Residual Plot* (upper left): This is a plot of the residuals versus predictive values from the model to assess the linearity and constant variance assumptions. \n\n- *Normal Quantile Plot* (upper right): Also known as a qq-plot, this plot allows us to assess the normality assumption. \n\n- *Histogram* (lower right): This is a histogram of the residuals with a overlaid normal density curve with mean and standard deviation computed from the residuals. It provides an additional way to check the normality assumption. This plot makes it clear that there is a slight right skew in the residuals from the penguin_model.\n\n- *Index Plot* (lower left): This is a plot of the residuals versus the observation numbers. It can help to find patterns related to the way that the data has been ordered, which may provide insights into additional trends in the data that have not been accounted for in the model.\n\n\n\nSome other examples: \n\n![](https://i.stack.imgur.com/RU17l.png)\n\n![](https://i.ytimg.com/vi/-KXy4i8awOg/maxresdefault.jpg)\n\n# Prediction \n\nSuppose the radar wind speed is 15 m/s. Use the model above to make a prediction for the amount of power produced. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#predict(power_model, 15)\n```\n:::\n\n\n\n## Interpolation vs. Extrapolation\n\n**Interpolation** is a method of estimating a hypothetical value that exists within a data set.\n\n**Extrapolation** is a method of estimation for hypothetical values that fall outside a data set.\n\n![](https://i.ytimg.com/vi/gbND5b0F8zc/maxresdefault.jpg)\n\n\n",
    "supporting": [
      "M_SLR_Blank_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}