{
  "hash": "d7f0ff799abaa6246a2d08dd8b4c34ed",
  "result": {
    "markdown": "---\ntitle: 'Animating plots using `gganimate`'\nauthor: 'Emily Malcolm-White'\nformat:\n  html: \n    toc: TRUE\n    code-overflow: wrap\n    embed-resources: true\n    code-tools:\n      source: true\n      toggle: false\n      caption: none\n    code-annotations: hover\nexecute: \n  message: FALSE\n  warning: FALSE\n---\n\n\n![Artwork by @allisonhorst](https://cdn.myportfolio.com/45214904-6a61-4e23-98d6-b140f8654a40/7606f921-3cf8-4240-b9a6-f31ebbe6cd6c_rw_1920.png?h=173381b1a16193a0f6cd17c89d4a58d5)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gganimate)\nlibrary(lubridate)\n```\n:::\n\n\n\n# Storms Data\n\nThe storms dataset from the dplyr package. This dataset tracks tropical storms in the North Atlantic, including wind speed, pressure, and location over time — making it perfect for animation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"storms\")\n```\n:::\n\n\n- `name`: storm name\n- `year`, `month`, `day`, `hour`: timestamp info\n- `lat`, `long`: geographic location\n- `wind`: wind speed (in knots)\n- `pressure`: atmospheric pressure (hPa)\n- `status`: classification (tropical storm, hurricane, etc.)\n\nLet’s animate the path of one specific storm -- Katrina in 2005. \n\nLet's get the data in an appropriate format. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkatrina <- storms %>%\n  filter(name == \"Katrina\", year == 2005) %>%\n  mutate(time = make_datetime(year, month, day, hour))\n```\n:::\n\n\nIt's usually useful to start with a static plot: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(katrina, aes(x = long, y = lat)) +\n  geom_path(color = \"gray\") +\n  geom_point(aes(size = wind, color = pressure), alpha = 0.8) +\n  coord_fixed() +\n  theme_minimal() +\n  labs(title = \"Hurricane Katrina: Wind and Pressure\", x = \"Longitude\", y = \"Latitude\")\n```\n\n::: {.cell-output-display}\n![](118_gganimate_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nI also think it would be cool to add a map behind it. Let's pull one from the `rnaturalearth` package. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\nlibrary(sf)\n\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot <- ggplot() +\n  # World landmasses\n  geom_sf(data = world, fill = \"#f0f0f0\", color=\"#8f8d8d\", linewidth = 0.3) +\n\n  # Map bounds\n  coord_sf(xlim = c(-95, -75), ylim = c(20, 40), expand = FALSE) +\n\n  # Storm path\n  geom_path(data = katrina, aes(x = long, y = lat), \n            color = \"gray40\", linewidth = 1, linetype = \"solid\") +\n\n  # Storm points7\n  geom_point(\n    data = katrina,\n    aes(x = long, y = lat, size = wind, color = pressure),\n    alpha = 0.8\n  ) +\n\n  # Scales\n  scale_color_gradient(low = \"#fee08b\", high = \"#d73027\", name = \"Pressure (hPa)\") +\n  scale_size(range = c(2, 15), name = \"Wind (knots)\", breaks = c(35, 65, 100)) +\n\n  # Labels\n  labs(\n    title = \"Hurricane Katrina (2005)\",\n    x = \"Longitude\", y = \"Latitude\"\n  ) +\n\n  # Themes\n  theme(\n    legend.position = \"right\",\n    panel.background = element_rect(fill = \"#e6f2ff\", color = NA)\n  )\n\nplot\n```\n\n::: {.cell-output-display}\n![](118_gganimate_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nTo animate this over time, you need to add `transition_time(time)`. It may take some time for this code to run on your computer. The animation will show up in the viewer pane on the left, instead of below the code. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot +\n  labs(\n    subtitle = \"Time: {frame_time}\",\n  ) +\n  transition_time(katrina$time) +\n  ease_aes(\"cubic-in-out\")\n```\n:::\n\n![](katrina.gif)\n\nYou need to save this as a .gif file: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nanim <- last_plot() %>%\n  animate(width = 700, height = 500, fps = 5, renderer = gifski_renderer())\n\nanim_save(\"katrina.gif\", anim)\n```\n:::\n\n\nYou can include this in your file using `![](katrina.gif)` inside plain text. ",
    "supporting": [
      "118_gganimate_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}